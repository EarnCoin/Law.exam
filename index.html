<!DOCTYPE html>
<html>
    <head><title>司律一試線上測驗</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta charset="utf-8">
        <meta property="og:title" content="司律一試線上測驗">
        <meta property="og:description" content="以司律一試考古題為基礎，提供線上題庫練習">
        <meta property="og:type" content="website">
        <meta name="theme-color" content="#6f42c1">
        <link href="//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
		<script src="//cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
        <style>
	

			.navbar-brand {
				width: 300px;
				overflow:hidden;
				white-space: nowrap;
				text-overflow: ellipsis;
			}
		
	

		.btn-primary {
    		background-color: #6f42c1 !important;
			border-color:purple !important;
		}	
	
	
        </style>
    </head>
    <body>
		
    <!-- Fixed navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark navbar-static-top" style="background-color: #6f42c1;">
      <div class="container-fluid">
		   <a class="navbar-brand" href="#">司律一試[年]</a>
		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>         
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
	
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

      

		  <div class="container">
            <div class="row">
			<p class="hidden-sm hidden-xs">&nbsp;</p>
                <h1 id="qa-quiz" class="col-md-12"></h1>
                <div id="qa-answer" class="col-md-12" style="font-size: 20pt;"></div>
                <h1 id="qa-result" class="col-md-12" style="color: red;"></h1>
                <div id="detail" class="col-md-12">
                    <div id="helper" class="col-md-8 col-sm-12 col-xs-12">
						<div class="d-flex btn-group btn-group-lg" role="group">
                            <button type="button" class="btn btn-primary  qa-previous" >
                                上一題
                            </button>
                            <button type="button" class="btn btn-primary  qa-jump" >
                                跳題
                            </button>
							<button type="button"class="btn btn-primary  qa-random" >
                                隨機
                            </button>
                            <button type="button" class="btn btn-primary qa-next">
                                下一題
                            </button>
                        </div>
                        <div class="col-md-12" id="qa-status"></div>
                    </div>
 
                </div>
            </div>
            <div style="text-align: center;">
                <a href="https://github.com/lagendre/law.exam" target="_blank">網站原始碼</a> |
                資料來源： <a href="https://wwwq.moex.gov.tw/exam/wFrmExamQandASearch.aspx" target="_blank">考選部考畢試題查詢平臺</a>
            </div>
        </div>
 
        <script>
        var currentIndex = 0, qa = [], total = 0;
		let menu ="";
        $(function() {
		for (let yr=110;yr>99;yr--){ //
			menu += '<li class="nav-item dropdown">' +
					'<a class="nav-link dropdown-toggle" href="#" id="'+ yr+'" role="button" data-bs-toggle="dropdown" aria-expanded="false">'+
					 yr + '</a>'+
					 '<ul class="dropdown-menu" aria-labelledby="'+ yr +'">';
			if (yr>102){
				menu += 
					'<li><a class="dropdown-item" href="#">'+yr+'綜合法學(一)(憲法、行政法、國際公法、國際私法)</a></li>'+
					'<li><a class="dropdown-item" href="#">'+yr+'綜合法學(二)(民法、民事訴訟法)</a></li>'+
					'<li><a class="dropdown-item" href="#">'+yr+'綜合法學(二)(公司法、保險法、票據法、證券交易法、強制執行法、法學英文)</a></li>'+
					'<li><a class="dropdown-item" href="#">'+yr+'綜合法學(一)(刑法、刑事訴訟法、法律倫理)</a></li>'+
					'</ul></li>';
			}
			else{
				menu += 
					'<li><a class="dropdown-item" href="#">'+yr+'司-綜合法學(一)(憲法、行政法、國際公法、國際私法)</a></li>'+
					'<li><a class="dropdown-item" href="#">'+yr+'律-綜合法學(一)(憲法、行政法、國際公法、國際私法)</a></li>'+
					'<li><a class="dropdown-item" href="#">'+yr+'司-綜合法學(二)(民法、民事訴訟法)</a></li>'+
					'<li><a class="dropdown-item" href="#">'+yr+'律-綜合法學(二)(民法、民事訴訟法)</a></li>'+
					'<li><a class="dropdown-item" href="#">'+yr+'司-綜合法學(二)(公司法、保險法、票據法、海商法、證券交易法、法學英文)</a></li>'+
					'<li><a class="dropdown-item" href="#">'+yr+'律-綜合法學(二)(公司法、保險法、票據法、海商法、證券交易法、法學英文)</a></li>'+
					'<li><a class="dropdown-item" href="#">'+yr+'司-綜合法學(一)(刑法、刑事訴訟法、法律倫理)</a></li>'+
					'<li><a class="dropdown-item" href="#">'+yr+'律-綜合法學(一)(刑法、刑事訴訟法、法律倫理)</a></li>'+
					'</ul></li>';
			}
			
		}

		$(".navbar-nav").html(menu);
		
	
		$('#qa-quiz').html("請選擇年度及考試!!");
		$("#helper").hide();
		
		$(".dropdown-item").click(function() {
			$("#helper").show();
			
			selectquiz( $(this).text() );
			
		});
	

          $('.qa-previous').click(function() {
            currentIndex -= 1;
            if(currentIndex < 0) {
              currentIndex = total - 1;
            }
            showQuiz();
            
          });
          $('.qa-next').click(function() {
            currentIndex += 1;
            if(currentIndex >= total) {
              currentIndex = 0;
            }
            showQuiz();
            
          });
          $('.qa-jump').click(function() {
            let inputIndex = parseInt( window.prompt('輸入 1-' + total + ' 數字') );
			if (!isNaN(inputIndex))
				currentIndex = inputIndex -1;
            showQuiz();
            
          });
		  $('.qa-random').click(function() {

			currentIndex = Math.floor(Math.random() * qa.length);
            showQuiz();
            
          });
	
        })
		
		function selectquiz( txt ){
		
		$('.navbar-brand').text( txt );
		
			txt = txt.slice(0,3)+ "/" + txt;
	
		
			qa = [];
			
			$.ajaxSettings.async = false;
			
			$.get( txt+'.txt', function(data) {
			
				let line = data.split('\n');
				let quiz, chA, chB, chC, chD, chE;
				let checkpoint = false;
				for ( let i=0;i < line.length;i++ ){
					if (checkpoint){
						chA="A."; chB="B."; chC="C."; chD="D."; chE="E.";
							
								if (!isNaN(parseFloat(line[i].replace(/\r/g, '')[0]))){
									if ( (//g).test(line[i+1]) ){ //choiceA.
										
										quiz = line[i];
										i++;
									}
									else{
										quiz="";
										for ( let j=0;j<5;j++ ){										
											if ( (//g).test(line[i+j])){
											 i= i+j;
											 break;
											}		
											quiz += line[i+j];
										}
									}
									

										if (( (//g).test(line[i]) )){ //choice D in  line
											chD += line[i].slice( line[i].indexOf('')+1, line[i].length);
											chC += line[i].slice(line[i].indexOf('')+1 , line[i].indexOf('') );
											chB += line[i].slice(line[i].indexOf('')+1 , line[i].indexOf('') );
											chA += line[i].slice(line[i].indexOf('')+1 , line[i].indexOf('') );
											chE = "";
											//i++;
										}
										else if (( (//g).test(line[i]) )) { //choice B in  line
											chB += line[i].slice(line[i].indexOf('')+1 , line[i].length );
											chA += line[i].slice(line[i].indexOf('')+1 , line[i].indexOf('') );
											chD += line[i+1].slice( line[i+1].indexOf('')+1, line[i+1].length);
											chC += line[i+1].slice(line[i+1].indexOf('')+1 , line[i+1].indexOf('') );
											chE = "";
											i=i+1;
										}
										else{
														
											
												
											chA += line[i].slice(1, line[i].length);
											for ( let j=1;j<5;j++ ){
												//line[i+j]= line[i+j].replace(/\r/g, '');
												if (  line[i+j].charAt(0)===''){
													i= i+j;
													break;
												}		
											chA += line[i+j];
											}
											if ((//g).test(line[i]) ) { //choice C in  line
											
												chC += line[i].slice(line[i].indexOf('')+1 , line[i].length );
												chB += line[i].slice(1 , line[i].indexOf('') );
												for ( let j=1;j<5;j++ ){	
													if (  line[i+j].charAt(0)===''){
														i= i+j;
													break;
													}		
												}
											}
											else{
												chB += line[i].slice(1, line[i].length);
												for ( let j=1;j<5;j++ ){
													//line[i+j]= line[i+j].replace(/\r/g, '');
													if ( line[i+j].charAt(0)==='' ){
													i= i+j;
													break;
												}		
												chB += line[i+j];
											}
											
												chC += line[i].slice(1, line[i].length);
												for ( let j=1;j<5;j++ ){	
												//line[i+j]= line[i+j].replace(/\r/g, '');
												if (  line[i+j].charAt(0)===''){
													i= i+j;
													break;
												}		
												chC += line[i+j];
												}
											}
								
												
											chD += line[i].slice(1, line[i].length);
											for ( let j=1;j<3;j++ ){	
												//line[i+j]= line[i+j].replace(/\r/g, '');
												
												if (  parseInt(line[i+j].slice(0, 2))==(qa.length+2)){
													i= i+j-1;
													chE = "";
													break;
												}
												else if (  line[i+j].charAt(0)===''){
													i= i+j;
													chE += line[i].slice(1, line[i].length);
													//i++;
													break;
												}
												else{
													chE="";
												}
												
												chD += line[i+j];
											}
											//i++;
			
 										}
								}
								else{
									//console.log(line[i]);
									continue;
								}
							
								qa.push({
								"quiz": quiz,
								"options": {
								"A": chA,
								"B": chB,
								"C": chC,
								"D": chD,
								"E": chE
								},
								"answer":null,
								"choice":1
								});						
					}
					else if ( line[i].indexOf('禁止使用電子計算器')!=-1 ){
						checkpoint= true;
					}
					else{
						//console.log(line[i]);
					}
				
				}//end of for loop	
				
			}, 'text');

			$.get( txt+'ANS.txt', function(data) {
					
				let line = data.split('\r');
				
				let index =0, ansArray=[];
				
				for ( let i=0;i<line.length;i++ ){
				
					if ( /[A-E]/g.test(line[i]) || line[i]==='#'){
						
						line[i] = line[i].replace(/\n/g, '')
						
						if (line[i].length!=1){
						
							ansArray=[];
							
							qa[index].choice= 2;
							
							for (var j=0; j<line[i].length; j++){

								ansArray.push( line[i][j] );
								
							}
							
							qa[index].answer = ansArray;
							
						}
						else{
							
							qa[index].answer= line[i];
						}
						
						index++;

						if ( index == qa.length)
							return;
					}
					
			
				}//end of for loop	
			}, 'text');

				$.ajaxSettings.async = true;
				
				total = qa.length;
				
				currentIndex = Math.floor(Math.random() * qa.length);
				
				showQuiz();
			
				
			
		}
		
        function showQuiz() {
		window.scrollTo(0, 0);
		
          if (currentIndex > qa.length)
			currentIndex=0;
			
		  $('#qa-result').html('');
          $('#qa-quiz').html(qa[currentIndex].quiz);
          var answers = '';
		  
		  if (qa[currentIndex].choice==1){
			for(k in qa[currentIndex].options) {
				if( qa[currentIndex].options[k].length!=0 )
				    answers +=  '<div class="form-check"><input class="form-check-input qa-options" type="radio" name="answer"  id="' + k + '" value="' + k + '">' +
						'<label class="form-check-label" for="'+ k +'">'+qa[currentIndex].options[k]+'</label></div>';
			}
		  }
		  else{
			for(k in qa[currentIndex].options) {
				if( qa[currentIndex].options[k].length!=0 )
					   answers +=  '<div class="form-check"><input class="form-check-input qa-multi-options" type="checkbox" name="answer"  id="' + k + '" value="' + k + '">' +
						'<label class="form-check-label" for="'+ k +'">'+qa[currentIndex].options[k]+'</label></div>';s
			}
			
			answers += '<button type="button" class="btn btn-secondary" onclick="multichoice()">答題</button>';
			
		  }
	  
		  
          $('#qa-answer').html(answers);
		  
          $('input.qa-options').change(function() {
		  
            var selected = $(this).val();
            if(selected == qa[currentIndex].answer) {
              $('#qa-result').html("你答對了！");
            }else if( qa[currentIndex].answer ==='#' ){
				$('#qa-result').html("本題一律給分！");
			}
			else {
              $('#qa-result').html("你答錯了！正確答案應該是 -> <br>" + qa[currentIndex].options[qa[currentIndex].answer]  );
            }
		window.scrollTo(0, document.body.scrollHeight);
          });
		  

		  
          $('div#qa-status').html('第 ' + (currentIndex + 1) + ' 題 / 共 ' + total + ' 題');
        }
		
		function multichoice() {
		
			var userAns = [];
			var checkboxes = document.getElementsByName('answer');
			
			for(let i = 0;i< checkboxes.length;  i++ )
			{
				if(checkboxes[i].checked){  
					userAns.push( checkboxes[i].value );
				}
			}
	
				if( JSON.stringify(userAns)!=JSON.stringify(qa[currentIndex].answer) ) {
					let theAns="";
					qa[currentIndex].answer.forEach(function(value){
						theAns +=  "<br>" + qa[currentIndex].options[value] ;
					});
					
					$('#qa-result').html("你答錯了！正確答案應該是 -> " + theAns );
				}
				else{
					$('#qa-result').html("你答對了！");
				}
			window.scrollTo(0, document.body.scrollHeight);
          }

        </script>
    </body>
</html>
